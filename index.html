<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Advanced IMEI Calculator Pro</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
 --bg:linear-gradient(135deg,#e3f2fd,#fce4ec);
 --card:#fff;--primary:#2196F3;--secondary:#4CAF50;--text:#222
}
body.dark{
 --bg:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
 --card:#1e1e1e;--primary:#00c6ff;--secondary:#43cea2;--text:#f1f1f1
}
body{
 background:var(--bg);
 font-family:sans-serif;
 padding:20px;
 color:var(--text)
}
.box{
 background:var(--card);
 max-width:480px;
 margin:auto;
 padding:25px;
 border-radius:16px;
 box-shadow:0 20px 40px rgba(0,0,0,.15)
}
h3,h4{text-align:center}
input,textarea,button{
 width:100%;
 padding:13px;
 margin-top:12px;
 border-radius:10px;
 border:none;
 font-size:16px
}
textarea,input{background:#f5f5f5}
body.dark textarea,body.dark input{background:#2a2a2a;color:#fff}
button{background:var(--primary);color:#fff;font-weight:600}
button.secondary{background:var(--secondary)}
button.gray{background:#9e9e9e}
.row{display:flex;gap:10px}
.result{
 margin-top:15px;
 padding:12px;
 border-radius:10px;
 background:rgba(0,0,0,.05);
 white-space:pre-wrap
}
.success{color:#2e7d32}
.error{color:#c62828}
footer{
 text-align:center;
 font-size:12px;
 opacity:.7;
 margin-top:20px
}
</style>
</head>

<body>
<div class="box">
<h3>üì± IMEI Calculator Pro</h3>

<input id="imei14" placeholder="Enter 14-digit IMEI" maxlength="14">
<button onclick="calculateIMEI()">Calculate</button>
<div class="result" id="result"></div>

<hr>

<h4>üîç Verify 15-digit IMEI</h4>
<input id="imei15" placeholder="Enter 15-digit IMEI" maxlength="15">
<button onclick="verifyIMEI()">Verify</button>
<div class="result" id="verifyResult"></div>
<div class="result" id="tacResult"></div>

<hr>

<h4>üì¶ Batch IMEI Tool</h4>
<textarea id="batch" rows="4"
placeholder="14-digit IMEI (one per line)"></textarea>
<button onclick="calculateBatch()">Process Batch</button>
<div class="result" id="batchResult"></div>

<div class="row">
 <button class="secondary" onclick="downloadCSV()">üìÑ CSV</button>
 <button class="secondary" onclick="downloadExcel()">üìä Excel</button>
</div>

<hr>
<button class="gray" onclick="toggleDarkMode()">üåó Dark Mode</button>

<footer>
¬© <span id="year"></span> IMEI Tool<br>
<span id="timestamp"></span><br>
<b>( Snatchers_09 )</b>
</footer>
</div>

<script>
let batchData=[];
const TAC_DB={
 "356938":"Apple iPhone",
 "357805":"Samsung Galaxy",
 "861234":"Xiaomi",
 "353918":"Nokia"
};

function luhnCheckDigit(n){
 let s=0;
 for(let i=0;i<14;i++){
  let d=+n[i];
  if(i%2){d*=2;if(d>9)d-=9}
  s+=d;
 }
 return (10-s%10)%10;
}

function calculateIMEI(){
 let v=imei14.value.trim();
 if(!/^\d{14}$/.test(v)){
  result.textContent="‚ùå Invalid IMEI";
  result.className="result error";
  return;
 }
 result.textContent="‚úÖ 15-digit IMEI: "+v+luhnCheckDigit(v);
 result.className="result success";
}

function verifyIMEI(){
 let v=imei15.value.trim();
 if(!/^\d{15}$/.test(v)){
  verifyResult.textContent="‚ùå Invalid IMEI";
  verifyResult.className="result error";
  tacResult.textContent="";
  return;
 }
 let base=v.slice(0,14);
 if(luhnCheckDigit(base)==v[14]){
  verifyResult.textContent="‚úÖ IMEI is VALID";
  verifyResult.className="result success";
  let tac=base.slice(0,6);
  tacResult.textContent="üè≠ "+(TAC_DB[tac]||"Unknown Device");
 }else{
  verifyResult.textContent="‚ùå IMEI is INVALID";
  verifyResult.className="result error";
  tacResult.textContent="";
 }
}

function calculateBatch(){
 batchData=[];
 let out="",sn=1;
 batch.value.split(/\n+/).forEach(l=>{
  l=l.trim();
  if(/^\d{14}$/.test(l)){
   let imei=l+luhnCheckDigit(l);
   batchData.push({sn,imei});
   out+=sn+". "+imei+"\n";
   sn++;
  }
 });
 batchResult.textContent=out||"‚ùå No valid IMEI found";
 batchResult.className=out?"result success":"result error";
}

function downloadCSV(){
 if(!batchData.length){alert("No batch data");return;}
 let csv="SN,IMEI\r\n";
 batchData.forEach(r=>csv+=r.sn+","+r.imei+"\r\n");
 triggerDownload(
  new Blob([csv],{type:"text/csv;charset=utf-8;"}),
  "batch_imei_report.csv"
 );
}

function downloadExcel(){
 if(!batchData.length){alert("No batch data");return;}
 let html=`<html><head><meta charset="UTF-8"></head><body>
 <table border="1"><tr><th>SN</th><th>IMEI</th></tr>`;
 batchData.forEach(r=>{
  html+=`<tr><td>${r.sn}</td><td>${r.imei}</td></tr>`;
 });
 html+=`</table></body></html>`;
 triggerDownload(
  new Blob([html],{type:"application/vnd.ms-excel;charset=utf-8;"}),
  "batch_imei_report.xls"
 );
}

function triggerDownload(blob,filename){
 let a=document.createElement("a");
 let url=URL.createObjectURL(blob);
 a.href=url;
 a.download=filename;
 document.body.appendChild(a);
 a.click();
 document.body.removeChild(a);
 URL.revokeObjectURL(url);
}

function toggleDarkMode(){
 document.body.classList.toggle("dark");
}

year.textContent=new Date().getFullYear();
timestamp.textContent=new Date().toLocaleString();
</script>
</body>
</html>
